name: CI

on: [push, pull_request]

jobs:
    lint:
        runs-on: ubuntu-latest

        strategy:
            matrix:
                service: [frontend, backend]

        steps:
            - name: Check out code
              uses: actions/checkout@v3

            - name: Run lint for ${{ matrix.service }}
              run: |
                  # Call the Makefile target for linting
                  make lint SERVICE=${{ matrix.service }}

    test:
        needs: lint
        runs-on: ubuntu-latest

        strategy:
            matrix:
                service: [frontend, backend]

        steps:
            - name: Check out code
              uses: actions/checkout@v3

            - name: Run tests for ${{ matrix.service }}
              run: |
                  # Call the Makefile target for testing
                  make test SERVICE=${{ matrix.service }}
